import numpy as np
import os
import time
import matplotlib.pyplot as plt

"""
This is basically a dump of the jupyter notebook I used to generate the adjacency matrix used in this layer. 
This therefore contains the used hierarchy.
"""


things_dict = { 'things': 'things',
                'indoor-super-things': 'things',
                'outdoor-super-things': 'things',
                'person-things': 'outdoor-super-things',
                'vehicle-things': 'outdoor-super-things',
                'outdoor-things': 'outdoor-super-things',
                'animal-things': 'outdoor-super-things',
                'accessory-things': 'outdoor-super-things',
                'sports-things': 'outdoor-super-things',
                'kitchen-things': 'indoor-super-things',
                'food-things': 'indoor-super-things',
                'furniture-things': 'indoor-super-things',
                'electronic-things': 'indoor-super-things',
                'appliance-things': 'indoor-super-things',
                'indoor-things': 'indoor-super-things',
                'person': 'person-things',
                'bicycle': 'vehicle-things',
                'car': 'vehicle-things',
                'motorcycle': 'vehicle-things',
                'airplane': 'vehicle-things',
                'bus': 'vehicle-things',
                'train': 'vehicle-things',
                'truck': 'vehicle-things',
                'boat': 'vehicle-things',
                'traffic light': 'outdoor-things',
                'fire hydrant': 'outdoor-things',
                'street sign': 'outdoor-things',
                'stop sign': 'outdoor-things',
                'parking meter': 'outdoor-things',
                'bench': 'outdoor-things',
                'bird': 'animal-things',
                'cat': 'animal-things',
                'dog': 'animal-things',
                'horse': 'animal-things',
                'sheep': 'animal-things',
                'cow': 'animal-things',
                'elephant': 'animal-things',
                'bear': 'animal-things',
                'zebra': 'animal-things',
                'giraffe': 'animal-things',
                'hat': 'accessory-things',
                'backpack': 'accessory-things',
                'umbrella': 'accessory-things',
                'shoe': 'accessory-things',
                'eye glasses': 'accessory-things',
                'handbag': 'accessory-things',
                'tie': 'accessory-things',
                'suitcase': 'accessory-things',
                'frisbee': 'sports-things',
                'skis': 'sports-things',
                'snowboard': 'sports-things',
                'sports ball': 'sports-things',
                'kite': 'sports-things',
                'baseball bat': 'sports-things',
                'baseball glove': 'sports-things',
                'skateboard': 'sports-things',
                'surfboard': 'sports-things',
                'tennis racket': 'sports-things',
                'bottle': 'kitchen-things',
                'plate': 'kitchen-things',
                'wine glass': 'kitchen-things',
                'cup': 'kitchen-things',
                'fork': 'kitchen-things',
                'knife': 'kitchen-things',
                'spoon': 'kitchen-things',
                'bowl': 'kitchen-things',
                'banana': 'food-things',
                'apple': 'food-things',
                'sandwich': 'food-things',
                'orange': 'food-things',
                'broccoli': 'food-things',
                'carrot': 'food-things',
                'hot dog': 'food-things',
                'pizza': 'food-things',
                'donut': 'food-things',
                'cake': 'food-things',
                'chair': 'furniture-things',
                'couch': 'furniture-things',
                'potted plant': 'furniture-things',
                'bed': 'furniture-things',
                'mirror': 'furniture-things',
                'dining table': 'furniture-things',
                'window': 'furniture-things',
                'desk': 'furniture-things',
                'toilet': 'furniture-things',
                'door': 'furniture-things',
                'tv': 'electronic-things',
                'laptop': 'electronic-things',
                'mouse': 'electronic-things',
                'remote': 'electronic-things',
                'keyboard': 'electronic-things',
                'cell phone': 'electronic-things',
                'microwave': 'appliance-things',
                'oven': 'appliance-things',
                'toaster': 'appliance-things',
                'sink': 'appliance-things',
                'refrigerator': 'appliance-things',
                'blender': 'appliance-things',
                'book': 'indoor-things',
                'clock': 'indoor-things',
                'vase': 'indoor-things',
                'scissors': 'indoor-things',
                'teddy bear': 'indoor-things',
                'hair drier': 'indoor-things',
                'toothbrush': 'indoor-things',
                'hair brush': 'indoor-things'
                }
stuff_dict = { 
                'stuff': 'stuff',
                'indoor-super-stuff': 'stuff',
                'outdoor-super-stuff': 'stuff',
                'rawmaterial-stuff': 'indoor-super-stuff',
                'wall-stuff': 'indoor-super-stuff',
                'ceiling-stuff': 'indoor-super-stuff',
                'floor-stuff': 'indoor-super-stuff',
                'window-stuff': 'indoor-super-stuff',
                'furniture-stuff': 'indoor-super-stuff',
                'textile-stuff': 'indoor-super-stuff',
                'food-stuff': 'indoor-super-stuff',
                'building-stuff': 'outdoor-super-stuff',
                'structural-stuff': 'outdoor-super-stuff',
                'plant-stuff': 'outdoor-super-stuff',
                'sky-stuff': 'outdoor-super-stuff',
                'solid-stuff': 'outdoor-super-stuff',
                'ground-stuff': 'outdoor-super-stuff',
                'water-stuff': 'outdoor-super-stuff',
                'cardboard': 'rawmaterial-stuff',
                'paper': 'rawmaterial-stuff',
                'plastic': 'rawmaterial-stuff',
                'metal': 'rawmaterial-stuff',
                'wall-tile': 'wall-stuff',
                'wall-panel': 'wall-stuff',
                'wall-wood': 'wall-stuff',
                'wall-brick': 'wall-stuff',
                'wall-stone': 'wall-stuff',
                'wall-concrete': 'wall-stuff',
                'wall-other': 'wall-stuff',
                'ceiling-tile': 'ceiling-stuff',
                'ceiling-other': 'ceiling-stuff',
                'carpet': 'floor-stuff',
                'floor-tile': 'floor-stuff',
                'floor-wood': 'floor-stuff',
                'floor-marble': 'floor-stuff',
                'floor-stone': 'floor-stuff',
                'floor-other': 'floor-stuff',
                'window-blind': 'window-stuff',
                'window-other': 'window-stuff',
                'door-stuff': 'furniture-stuff',
                'desk-stuff': 'furniture-stuff',
                'table': 'furniture-stuff',
                'shelf': 'furniture-stuff',
                'cabinet': 'furniture-stuff',
                'cupboard': 'furniture-stuff',
                'mirror-stuff': 'furniture-stuff',
                'counter': 'furniture-stuff',
                'light': 'furniture-stuff',
                'stairs': 'furniture-stuff',
                'furniture-other': 'furniture-stuff',
                'rug': 'textile-stuff',
                'mat': 'textile-stuff',
                'towel': 'textile-stuff',
                'napkin': 'textile-stuff',
                'clothes': 'textile-stuff',
                'cloth': 'textile-stuff',
                'curtain': 'textile-stuff',
                'blanket': 'textile-stuff',
                'pillow': 'textile-stuff',
                'banner': 'textile-stuff',
                'textile-other': 'textile-stuff',
                'fruit': 'food-stuff',
                'salad': 'food-stuff',
                'vegetable': 'food-stuff',
                'food-other': 'food-stuff',
                'house': 'building-stuff',
                'skyscraper': 'building-stuff',
                'bridge': 'building-stuff',
                'tent': 'building-stuff',
                'roof': 'building-stuff',
                'building-other': 'building-stuff',
                'fence': 'structural-stuff',
                'cage': 'structural-stuff',
                'net': 'structural-stuff',
                'railing': 'structural-stuff',
                'structural-other': 'structural-stuff',
                'grass': 'plant-stuff',
                'tree': 'plant-stuff',
                'bush': 'plant-stuff',
                'leaves': 'plant-stuff',
                'flower': 'plant-stuff',
                'branch': 'plant-stuff',
                'moss': 'plant-stuff',
                'straw': 'plant-stuff',
                'plant-other': 'plant-stuff',
                'clouds': 'sky-stuff',
                'sky-other': 'sky-stuff',
                'wood': 'solid-stuff',
                'rock': 'solid-stuff',
                'stone': 'solid-stuff',
                'mountain': 'solid-stuff',
                'hill': 'solid-stuff',
                'solid-other': 'solid-stuff',
                'sand': 'ground-stuff',
                'snow': 'ground-stuff',
                'dirt': 'ground-stuff',
                'mud': 'ground-stuff',
                'gravel': 'ground-stuff',
                'road': 'ground-stuff',
                'pavement': 'ground-stuff',
                'railroad': 'ground-stuff',
                'platform': 'ground-stuff',
                'playingfield': 'ground-stuff',
                'ground-other': 'ground-stuff',
                'fog': 'water-stuff',
                'river': 'water-stuff',
                'sea': 'water-stuff',
                'waterdrops': 'water-stuff',
                'water-other': 'water-stuff',
                }

all_dict = {
                'stuff': 'stuff',
                'indoor': 'stuff',
                'outdoor': 'stuff',
                'rawmaterial': 'indoor',
                'wall': 'indoor',
                'ceiling': 'indoor',
                'floor': 'indoor',
                'window': 'indoor',
                'furniture': 'indoor',
                'textile': 'indoor',
                'food': 'indoor',
                'building': 'outdoor',
                'structural': 'outdoor',
                'plant': 'outdoor',
                'sky': 'outdoor',
                'solid': 'outdoor',
                'ground': 'outdoor',
                'water': 'outdoor',
                'cardboard': 'rawmaterial',
                'paper': 'rawmaterial',
                'plastic': 'rawmaterial',
                'metal': 'rawmaterial',
                'wall-tile': 'wall',
                'wall-panel': 'wall',
                'wall-wood': 'wall',
                'wall-brick': 'wall',
                'wall-stone': 'wall',
                'wall-concrete': 'wall',
                'wall-other': 'wall',
                'ceiling-tile': 'ceiling',
                'ceiling-other': 'ceiling',
                'carpet': 'floor',
                'floor-tile': 'floor',
                'floor-wood': 'floor',
                'floor-marble': 'floor',
                'floor-stone': 'floor',
                'floor-other': 'floor',
                'window-blind': 'window',
                'window-other': 'window',
                'door': 'furniture',
                'desk': 'furniture',
                'table': 'furniture',
                'shelf': 'furniture',
                'cabinet': 'furniture',
                'cupboard': 'furniture',
                'mirror': 'furniture',
                'counter': 'furniture',
                'light': 'furniture',
                'stairs': 'furniture',
                'furniture-other': 'furniture',
                'rug': 'textile',
                'mat': 'textile',
                'towel': 'textile',
                'napkin': 'textile',
                'clothes': 'textile',
                'cloth': 'textile',
                'curtain': 'textile',
                'blanket': 'textile',
                'pillow': 'textile',
                'banner': 'textile',
                'textile-other': 'textile',
                'fruit': 'food',
                'salad': 'food',
                'vegetable': 'food',
                'food-other': 'food',
                'house': 'building',
                'skyscraper': 'building',
                'bridge': 'building',
                'tent': 'building',
                'roof': 'building',
                'building-other': 'building',
                'fence': 'structural',
                'cage': 'structural',
                'net': 'structural',
                'railing': 'structural',
                'structural-other': 'structural',
                'grass': 'plant',
                'tree': 'plant',
                'bush': 'plant',
                'leaves': 'plant',
                'flower': 'plant',
                'branch': 'plant',
                'moss': 'plant',
                'straw': 'plant',
                'plant-other': 'plant',
                'clouds': 'sky',
                'sky-other': 'sky',
                'wood': 'solid',
                'rock': 'solid',
                'stone': 'solid',
                'mountain': 'solid',
                'hill': 'solid',
                'solid-other': 'solid',
                'sand': 'ground',
                'snow': 'ground',
                'dirt': 'ground',
                'mud': 'ground',
                'gravel': 'ground',
                'road': 'ground',
                'pavement': 'ground',
                'railroad': 'ground',
                'platform': 'ground',
                'playingfield': 'ground',
                'ground-other': 'ground',
                'fog': 'water',
                'river': 'water',
                'sea': 'water',
                'waterdrops': 'water',
                'water-other': 'water',
                'things': 'things',
                'indoor': 'things',
                'outdoor': 'things',
                'person': 'outdoor',
                'vehicle': 'outdoor',
                'outdoor': 'outdoor',
                'animal': 'outdoor',
                'accessory': 'outdoor',
                'sports': 'outdoor',
                'kitchen': 'indoor',
                'food': 'indoor',
                'furniture': 'indoor',
                'electronic': 'indoor',
                'appliance': 'indoor',
                'indoor': 'indoor',
                'person': 'person',
                'bicycle': 'vehicle',
                'car': 'vehicle',
                'motorcycle': 'vehicle',
                'airplane': 'vehicle',
                'bus': 'vehicle',
                'train': 'vehicle',
                'truck': 'vehicle',
                'boat': 'vehicle',
                'traffic light': 'outdoor',
                'fire hydrant': 'outdoor',
                'street sign': 'outdoor',
                'stop sign': 'outdoor',
                'parking meter': 'outdoor',
                'bench': 'outdoor',
                'bird': 'animal',
                'cat': 'animal',
                'dog': 'animal',
                'horse': 'animal',
                'sheep': 'animal',
                'cow': 'animal',
                'elephant': 'animal',
                'bear': 'animal',
                'zebra': 'animal',
                'giraffe': 'animal',
                'hat': 'accessory',
                'backpack': 'accessory',
                'umbrella': 'accessory',
                'shoe': 'accessory',
                'eye glasses': 'accessory',
                'handbag': 'accessory',
                'tie': 'accessory',
                'suitcase': 'accessory',
                'frisbee': 'sports',
                'skis': 'sports',
                'snowboard': 'sports',
                'sports ball': 'sports',
                'kite': 'sports',
                'baseball bat': 'sports',
                'baseball glove': 'sports',
                'skateboard': 'sports',
                'surfboard': 'sports',
                'tennis racket': 'sports',
                'bottle': 'kitchen',
                'plate': 'kitchen',
                'wine glass': 'kitchen',
                'cup': 'kitchen',
                'fork': 'kitchen',
                'knife': 'kitchen',
                'spoon': 'kitchen',
                'bowl': 'kitchen',
                'banana': 'food',
                'apple': 'food',
                'sandwich': 'food',
                'orange': 'food',
                'broccoli': 'food',
                'carrot': 'food',
                'hot dog': 'food',
                'pizza': 'food',
                'donut': 'food',
                'cake': 'food',
                'chair': 'furniture',
                'couch': 'furniture',
                'potted plant': 'furniture',
                'bed': 'furniture',
                'mirror': 'furniture',
                'dining table': 'furniture',
                'window': 'furniture',
                'desk': 'furniture',
                'toilet': 'furniture',
                'door': 'furniture',
                'tv': 'electronic',
                'laptop': 'electronic',
                'mouse': 'electronic',
                'remote': 'electronic',
                'keyboard': 'electronic',
                'cell phone': 'electronic',
                'microwave': 'appliance',
                'oven': 'appliance',
                'toaster': 'appliance',
                'sink': 'appliance',
                'refrigerator': 'appliance',
                'blender': 'appliance',
                'book': 'indoor',
                'clock': 'indoor',
                'vase': 'indoor',
                'scissors': 'indoor',
                'teddy bear': 'indoor',
                'hair drier': 'indoor',
                'toothbrush': 'indoor',
                'hair brush': 'indoor'
    
}

# Dictionary has structure {leaf : parent}
# Also includes a self connection stuff-> stuff at the top parent,
# so the leaves contain ALL the entities

def make_adjacency_matrix(connection_dict, directed=True):
    # Connection is from  row TO collumn.
    all_words = np.unique(list(connection_dict.keys())) # Assumption! See text above
    M = len(all_words)
    

    word2idx = {word:i for (i,word) in enumerate(all_words)}
    idx2word = {i:word for (i,word) in enumerate(all_words)}
    adj_m = np.zeros((M,M))
    for leaf in connection_dict.keys():
        parent = connection_dict[leaf]
        adj_m[word2idx[parent],word2idx[leaf]] = 1 # Adds connection from parent to child
        if not directed:
            adj_m[word2idx[leaf],word2idx[parent]] = 1 # Adds connection back from child to parent
    return adj_m, word2idx, idx2word, all_words

# Adjacency matrix A
# word2idx, idx2word maps words to integers, ordered as 'all_words'
A, word2idx,idx2word,all_words = make_adjacency_matrix(all_dict)
plt.figure(figsize=(20,20))
plt.xticks(np.arange(len(all_words[:50])), all_words, rotation='vertical')
plt.yticks(np.arange(len(all_words[:50])), all_words)
plt.grid()
plt.imshow(A[:50,:50])
plt.show()
